SELECT PID, SUM(SALE) AS total, 
RANK() OVER (ORDER BY SUM(SALE) DESC) AS rank
FROM Sales 
GROUP BY PID 
ORDER BY rank; 